#REQUIRE KEYS
is=["8000000000000120","8000000000000053","8000000000000000"]p=println pr=print pe={pause()exit()}p("Factory Reset\n")op=["Beenden","Loesche sysmmc"].copy()if(emu()){op+"Loesche emummc"}r=menu(op,0)clear()if(r==0){exit()}if(r==1){mount=mountsys selected_target="sysmmc loeschen"}if(r==2){mount=mountemu selected_target="emummc loeschen"}if(mount("SYSTEM")){p("Mounten fehlgeschlagen!")pe()}clear()border={setpixels(0,0,1279,19,border_color)setpixels(0,700,1279,719,border_color)setpixels(0,20,19,699,border_color)setpixels(1260,20,1279,699,border_color)}i=10 x_pos=10 y_pos=12["WARNUNG !!!","","Moechtest du wirklich alles loeschen?","Dies beinhaltet:","- Spielstaende","- Spieldaten","- und alle anderen System Daten!","","Das Wiederherstellen eines eMMC-Backups ist immer zu bevorzugen.","Bitte benutze dies nur als letztes Mittel.","Dieses Skript ist dazu gedacht, beim Entbrickungsprozess zu helfen."].foreach("line"){printpos(x_pos,y_pos)y_pos=y_pos+1 print(line)}if(!fsexists("bis:/save/"+is[1])){["","DeviceSettings save (8000000000000053) fehlt!!!","Dieses Skript kann verlorene Batteriekalibrierungsdaten nicht wiederherstellen!","Das System wird mit Standardwerten initialisiert.","Diese Werte sind fÃ¼r Lite-Systeme unsicher!"].foreach("line"){printpos(x_pos,y_pos)y_pos=y_pos+1 print(line)}}time=5000 y_pos=y_pos+4 while(i>0){i=i- 1 if(i%2==0){border_color=0xFF0000}.else(){border_color=0x000000}border()sleep(500)time=time- 500 printpos(x_pos,y_pos)print("Warte fuer",time/1000,"sek.")}printpos(x_pos,y_pos)print("Moechtest du den",selected_target,"?           ")y_pos=y_pos+1 printpos(x_pos,y_pos)print("Druecken die Powertaste um alles zu loeschen,")y_pos=y_pos+1 printpos(x_pos,y_pos)print("oder eine beliebige Taste zum Beenden.")result=pause(0x70F000F)if(!result.power){exit()}clear()color(0xFF0000)pr("Loesche System-Speicherstaende... ")f=readdir("bis:/save")if(f.folders.len()!=0){p("Ordner im Speicherverzeichnis???")pe()}f.files.foreach("x"){if(!is.contains(x)){if(delfile("bis:/save/"+x)){p("File deletion failed: ",x)pe()}}}pr("Fertig!\nEinrichtung des Index-Saves...")if(fsexists("bis:/save/"+is[0])){ba0=["BYTE[]",0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00]ba120=["BYTE[]",0x20,0x01,0x00,0x00,0x00,0x00,0x00,0x80]ba53=["BYTE[]",0x53,0x00,0x00,0x00,0x00,0x00,0x00,0x80]imen=["BYTE[]",0x49,0x4D,0x45,0x4E,0x40,0x00,0x00,0x00,0x40,0x00,0x00,0x00]idb=["BYTE[]",0x49,0x4D,0x4B,0x56,0x00,0x00,0x00,0x00].copy()skip53=!fsexists("bis:/save/"+is[1])if(skip53){idb.add(0x01)pr("053-Save nicht gefunden!!! Ueberspringe die Indizierung...")}.else(){idb.add(0x02)}idb.add(0x00)idb.add(0x00)idb.add(0x00)if(!skip53){s=getfilesize("bis:/save/"+is[1])s1=s&0xFF s2=(s>>8)&0xFF s3=(s>>16)&0xFF s4=(s>>24)&0xFF idb.addrange(imen)idb.addrange(ba0)idb.addrange(ba0)idb.addrange(ba0)idb.addrange(ba53)idb.addrange(ba0)idb.addrange(ba0)idb.addrange(ba0)idb.addrange(ba0)idb.addrange(ba53)idb.add(s1)idb.add(s2)idb.add(s3)idb.add(s4)idb.add(0x00)idb.add(0x00)idb.add(0x00)idb.add(0x00)idb.addrange(ba0)idb.addrange(ba0)idb.addrange(ba0)idb.addrange(ba0)idb.addrange(ba0)idb.addrange(ba0)}s=getfilesize("bis:/save/"+is[0])s1=s&0xFF s2=(s>>8)&0xFF s3=(s>>16)&0xFF s4=(s>>24)&0xFF idb.addrange(imen)idb.addrange(ba0)idb.addrange(ba0)idb.addrange(ba0)idb.addrange(ba120)idb.addrange(ba0)idb.addrange(ba0)idb.addrange(ba0)idb.addrange(ba0)idb.addrange(ba120)idb.add(s1)idb.add(s2)idb.add(s3)idb.add(s4)idb.add(0x00)idb.add(0x00)idb.add(0x00)idb.add(0x00)idb.addrange(ba0)idb.addrange(ba0)idb.addrange(ba0)idb.addrange(ba0)idb.addrange(ba0)idb.addrange(ba0)idxs=readsave("bis:/save/"+is[2])if(idxs.resize("/imkvdb.arc",idb.len())){p("imkvdb resize failed")pe()}if(idxs.write("/imkvdb.arc",idb)){p("imkvdb write failed")pe()}if(idxs.resize("/lastPublishedId",ba0.len())){p("lastPublishedId resize failed")pe()}if(idxs.write("/lastPublishedId",ba0)){p("lastPublishedId write failed")pe()}if(idxs.commit()){p("Index Save konnte nicht gespeichert werden.")pe()}idxs=0 pr("Fertig!")}.else(){pr("120-Save nicht gefunden!!! Ueberspringe die Bearbeitung des Index-Saves!!!")}pr("\nLoesche Benutzerverzeichnisse...")ud=["Album","Contents","save","saveMeta","temp"]if(mount("USER")){p("Mounten Fehlgeschlagen!")pe()}ud.foreach("x"){pr("\n"+x,"")if(deldir("bis:/"+x)){p("Loeschen des Verzeichnisses fehlgeschlagen!")pe()}mkdir("bis:/"+x)}mkdir("bis:/Contents/placehld")mkdir("bis:/Contents/registered")color(0x00FF00)p("\n\nFertig!")pause()